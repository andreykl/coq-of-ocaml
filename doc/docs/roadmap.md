---
id: roadmap
title: Future
---

We present some of the things we have done, and what we could do in the future.

## Done
Our main achievement is the translation of the economic protocol (kernel) of the [Tezos crypto-currency](https://tezos.com/) to a valid [Coq](https://coq.inria.fr/) program. We present the results on our [example page](https://foobar-land.github.io/coq-of-ocaml/examples/tezos/). This amounts to the translation of around 40.000 lines of [OCaml](https://ocaml.org/), including the definition of interfaces.

## coq-of-ocaml as a kit
Here are some of the tasks that we could do, with an estimated cost in days:
* support extensible types with casts **(1 day)**:
  * define values of extensible types as `string * {A : Set @ A}`, maybe with a single constructor to differentiate the different extensible types;
  * in a `match`, do an unsafe cast to get the correct value for the existential type `A`;
  
  We use the extensible types for the error messages in Tezos. We could also replace these extensible types by standard algebraic types. Indeed, we statically know all the possible cases. However, this may require splitting and relocating the code of some of the files.
* have full test-coverage **(2 days)**:
  * we only have unit tests for the main cases;
  * we use the Tezos code-base as a huge non-regression test;
  * we could track the lines covered by our unit tests and make sure we get to 100%;
* have a configuration file **(1 day + 1 day of stabilization and documentation)**:
  * we currently use a fork of `coq-of-ocaml` to have special features like renaming some variables with collisions;
  * we would like to have a configuration file instead;
* upgrade to OCaml 4.09 **(1 day + maybe a few days if this creates nasty bugs)**:
  * necessary since we [upgraded to OCaml 4.09](https://gitlab.com/tezos/tezos/-/merge_requests/1632);
  * requires to upgrade our [Merlin](https://github.com/ocaml/merlin) version too, as the one we used is not compatible;
* have a protocol which we can compile back to OCaml **(1 week + potentially many preliminary tasks)**:
  * there are some parts of the protocol which we do not import yet, like `let () = ...` at top-level;
  * having a Coq protocol which we can test in OCaml with the test-suite would increase confidence in our work;
  * require to import all the small bits which we ignored till then;
  * require to connect the axioms generated by the protocol environment to their actual implementation;
* verify the gas **(one week)**:
  * check that the gas count does not impact the output of standard operations (apart from the fact that such operations may fail if there is not enough gas);
  * check basic properties on the gas operations (the gas count commutes with the addition for example);
* compile everything with the storage **(1 day, maybe more, investigation)**:
  * we currently compile files depending on `storage.ml` using the Coq file generated from the interface `storage.mli`;
  * this is due to the performance impact of using the full definitions of the storage in place of its axioms;
  * there are no reasons why this should be the case;
  * investigate why and fix it;
* upgrade the import of the Tezos protocol to Carthage **(2 days)**:
  * we currently import the Babylon protocol of Tezos;
  * do the same for the Cartharge version;
* integrate into the CI of the development of the next Tezos protocol **(3 days, but many preliminary tasks)**:
  * being into the CI of Tezos would help to maintain the proofs for the evolving protocol;
  * the cheapest way to integrate into the CI seems to be to verify that there no regressions on the warnings from `coq-of-ocaml`;
  * requires to be compatible with the current protocol;
  * requires to have a more precise way to sort-out the warnings, as some can not be removed for now;
  * requires to be up-to-date with the current environment.

## GADTs
As a more long term project, we would also like to support the GADTs in a proper way.
